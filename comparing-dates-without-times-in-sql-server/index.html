<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Stillnet Studios  &raquo; Blog Archive   &raquo; Comparing dates without times in SQL Server</title>

<meta name="generator" content="WordPress 6.1.1"> <!-- leave this for stats -->

<link rel="stylesheet" href="/wp-content/themes/evanescence-12/style.css" type="text/css" media="screen">
<link rel="alternate" type="application/rss+xml" title="Stillnet Studios RSS Feed" href="/feed/">
<link rel="pingback" href="/xmlrpc.php">

<meta name="robots" content="max-image-preview:large">
				
	<script type="text/javascript">//<![CDATA[
	// Google Analytics for WordPress by Yoast v4.2.3 | http://yoast.com/wordpress/google-analytics/
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount','UA-1413191-1']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
	//]]></script>
<link rel="alternate" type="application/rss+xml" title="Stillnet Studios &raquo; Comparing dates without times in SQL Server Comments Feed" href="/comparing-dates-without-times-in-sql-server/feed/">
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"httpwww.stillnetstudios.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.1.1"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(p&&p.fillText)switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style>
	<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.1.1" type="text/css" media="all">
<link rel="stylesheet" id="classic-theme-styles-css" href="/wp-includes/css/classic-themes.min.css?ver=1" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}</style>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/20">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress 6.1.1">
<link rel="canonical" href="/comparing-dates-without-times-in-sql-server/">
<link rel="shortlink" href="/?p=20">
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Fcomparing-dates-without-times-in-sql-server%2F">
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Fcomparing-dates-without-times-in-sql-server%2F&#038;format=xml">
</head>

<body>
<div id="page">

<div id="header">
<div><div>	
	<div class="header-title">
		<h1><a href="/" title="Stillnet Studios: Web development notes and commentary from Ryan Stille">Stillnet Studios</a></h1>
		<p>Web development notes and commentary from Ryan Stille</p>
	</div> 
	<!-- Search box (If you prefer having search form as a sidebar widget, remove this block) -->
	<div class="search">
		<form method="get" id="searchform" action="http://www.stillnetstudios.com/">
<input type="text" size="12" name="s" id="s" value="search..." onblur="if(this.value=='') this.value='search...';" onfocus="if(this.value=='search...') this.value='';">
</form>
	</div> 
	<!-- Search ends here-->
</div></div>	
</div>
<div id="wrapper">

	<div id="content">

			
		<div class="navigation">
			<div class="alignleft">&laquo; <a href="/eclipse-sucks/" rel="prev">Hey Eclipse &#8211; Call me when you grow up</a>
</div>
			<div class="alignright">
<a href="/no-more-reset-buttons-please/" rel="next">No more reset buttons, please!</a> &raquo;</div>
		</div>

		<div class="post" id="post-20">
			<div class="post-title"><div>
				<h2><a href="/comparing-dates-without-times-in-sql-server/" rel="bookmark" title="Permanent Link to Comparing dates without times in SQL Server">Comparing dates without times in SQL Server</a></h2>
			</div></div>
			<div class="post-entry">
				<p>Sometimes you have the need in an application to compare dates without the time component.  For example, a user signs up for a free 30-day trial of a client&#8217;s site.  The user&#8217;s &#8216;expire_date&#8217; will be set for 30 days from today, probably using something like DateAdd(&#8220;d&#8221;,30,getdate()).  At some point you need to compare the expire_date against the current date.  Maybe its a report of current free trial users, or a query to see if the user is allowed to login.  Your query will look something like</p>
<p><code>... WHERE expire_date &gt;= getdate()</code></p>
<p>The problem with this is that both values contain a time component.  What you are really comparing is something like</p>
<p><code>... WHERE <em>2007-1-20 10:44:22.717</em> &gt;= <em>2007-1-20 10:30:28.287</em></code></p>
<p>  So a user may be considered still in their free trial at 10:30am, but when they try to login again 20 minutes later, they may be told their trial has expired.  In reality the free trial should continue throughout the last day of the trial period.  If you signed up for a free two week gym membership, would you expect to be allowed in before lunch on the last day but not after because of what time you initially signed up?</p>
<p>This is not a problem in MySQL, as it has a simple DATE type (in addition to the common DATETIME type) that does not store any time data.  So what we need to do in SQL Server is strip off the time component.  I typically do this when I store the date, but you could do it at compare time, too.</p>
<p>SQL Server datetimes are stored internally as floating point numbers.  You can see this by CASTing the value of getdate to a float.</p>
<p><code>SELECT CAST( getdate() AS float)</code></p>
<p>When I ran this just now I got 39100.964272067904.  That indicates 39100 days after 1/1/1900 (SQL Server&#8217;s base date), and 96/100ths of a fractional day (it&#8217;s almost midnight).  We can use this to modify the float value and then CAST it back as a datetime type.  The FLOOR function will strip off any decimal portion of a number.  Thus:</p>
<p><code>SELECT CAST(FLOOR(CAST( getdate() AS float)) AS datetime)</code></p>
<p>returns &#8220;2007-01-20 00:00:00.000&#8221; &#8211; the date without the time.</p>
<p>There are other ways to do this, using the day, month and year functions or the CONVERT function.  I find the above method to be more straight forward  (although only by a little &#8211; its a pain no matter how you do it).  You could add that code to a trigger so whenever that field is set or updated the time portion is automatically stripped off.</p>
<p>Now when we compare the field, we&#8217;ll need to do the same conversion to the current day:</p>
<p><code>... WHERE expire_date &gt;= CAST(FLOOR(CAST( getdate() AS float)) AS datetime)</code></p>
<p>Keep in mind that queries with functions in the search condition are expensive.  If you are going to run this often or on a lot of data, you may want to pass in the date from your application language:</p>
<p><code>... WHERE expire_date &gt;= '2007-01-20'</code></p>
							</div>
	
			<p class="post-meta">
					This entry was posted on 20 January 2007 at 11:51 pm					and is filed under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.
					You can follow any responses to this entry through the <a href="/comparing-dates-without-times-in-sql-server/feed/">RSS 2.0</a> feed.

											Both comments and pings are currently closed.

					
			</p>
		</div>
	
<!-- You can start editing here. -->
<div id="comments">
	<h3>35 Comments</h3>

	<ol class="commentlist">

	
		<li class="alt" id="comment-79">
			<h4>john says:</h4>
			<p>how about Comparing time without dates in SQL Server??</p>
						<small class="commentmetadata"><a href="#comment-79" title="">19 July 2007, 8:52 pm</a></small>
					</li>

	
	
		<li class="" id="comment-80">
			<h4>Marlene says:</h4>
			<p>How do I replace getdate() with query criteria entered by the user.</p>
<p>I.e., select *<br>
from [my table]<br>
where CAST(FLOOR(CAST( [my date field] AS float)) AS datetime) =<br>
(SELECT CAST(FLOOR(CAST( 07/23/2007 AS float)) AS datetime))</p>
<p>Thank you. This is very cool and I&#8217;d like to use it if I can replace getdate() with my own date value.</p>
						<small class="commentmetadata"><a href="#comment-80" title="">23 July 2007, 6:15 pm</a></small>
					</li>

	
	
		<li class="alt" id="comment-81">
			<h4>Marlene says:</h4>
			<p>Sorry, I should&#8217;ve given myself 5 more minutes to figure it out.  Unless there&#8217;s a better way than&#8230;</p>
<p> select *<br>
 from [my table]<br>
 where CAST(FLOOR(CAST( [my date field] AS float)) AS datetime) =<br>
 (SELECT CAST(FLOOR(CAST( cast (&#8217;07-23-2007&#8242; as datetime) AS float)) AS datetime))</p>
<p>I don&#8217;t know if there&#8217;s a simpler, less confusing way to do it.</p>
						<small class="commentmetadata"><a href="#comment-81" title="">23 July 2007, 6:21 pm</a></small>
					</li>

	
	
		<li class="" id="comment-82">
			<h4>Azizah says:</h4>
			<p>I&#8217;m confuse already. But your post really contain lots of information on SQL server that I don&#8217;t understand much about before.</p>
						<small class="commentmetadata"><a href="#comment-82" title="">7 August 2007, 3:02 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-83">
			<h4>
<a href="http://www/" rel="external nofollow ugc" class="url">Kysy</a> says:</h4>
			<p>Nice, but this solution don&#8217;t use indices related to datetime or smalldatetime fields. Very baaad in many situations!</p>
<p>WHERE CAST(FLOOR(CAST( cast (getdate() as datetime) AS float)) AS datetime))</p>
						<small class="commentmetadata"><a href="#comment-83" title="">28 August 2007, 4:46 am</a></small>
					</li>

	
	
		<li class="" id="comment-84">
			<h4>
<a href="http://www.fancyacar.co.uk/" rel="external nofollow ugc" class="url">Instructor</a> says:</h4>
			<p>Thanks a lot for this tip. I was looking exactly for that!</p>
						<small class="commentmetadata"><a href="#comment-84" title="">6 September 2007, 3:53 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-85">
			<h4>John says:</h4>
			<p>Thanks it helped a lot.</p>
						<small class="commentmetadata"><a href="#comment-85" title="">5 October 2007, 10:52 am</a></small>
					</li>

	
	
		<li class="" id="comment-86">
			<h4>Manin says:</h4>
			<p>like mentioned in the article, we could also compare by having 3 condition which is day,month and year.. its easier and clearer to understand but more syntax involved. was lookin for an alternative and i think this is it .</p>
						<small class="commentmetadata"><a href="#comment-86" title="">4 November 2007, 11:34 pm</a></small>
					</li>

	
	
		<li class="alt" id="comment-87">
			<h4>Jeff says:</h4>
			<p>Thanks for the help.  It saved me a lot of trouble</p>
						<small class="commentmetadata"><a href="#comment-87" title="">5 December 2007, 11:37 am</a></small>
					</li>

	
	
		<li class="" id="comment-88">
			<h4>David says:</h4>
			<p>I would simply using the following to create ‘expire_date’ .</p>
<p>DateAdd(&#8220;d&#8221;,31,convert(varchar(10), getdate(), 102) )</p>
<p>The system will see it as Midnight 31 days from now, which is technically when you would want to cutoff.</p>
<p>Then you don&#8217;t have to worry about the time factor later.</p>
						<small class="commentmetadata"><a href="#comment-88" title="">26 December 2007, 2:56 pm</a></small>
					</li>

	
	
		<li class="alt" id="comment-89">
			<h4>
<a href="http://stillnetstudios.com/" rel="external nofollow ugc" class="url">Ulises Moreno</a> says:</h4>
			<p>Very Helpful information, this is the first time i see this compare way</p>
						<small class="commentmetadata"><a href="#comment-89" title="">13 May 2008, 4:31 pm</a></small>
					</li>

	
	
		<li class="" id="comment-90">
			<h4>smcleod says:</h4>
			<p>You just saved me a bunch of time and made this much simpler in our code.  Thanks SO MUCH for sharing this!</p>
						<small class="commentmetadata"><a href="#comment-90" title="">26 June 2008, 9:55 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-91">
			<h4>José says:</h4>
			<p>I find it more straightforward to use DATEDIFF.</p>
<p>if DATEDIFF ( day , startdate , enddate ) = 0 then it is the same date.</p>
						<small class="commentmetadata"><a href="#comment-91" title="">29 June 2008, 5:47 pm</a></small>
					</li>

	
	
		<li class="" id="comment-92">
			<h4>
<a href="http://www.wilmsoft.com/" rel="external nofollow ugc" class="url">wilmsoft</a> says:</h4>
			<p>Why in the world doesn&#8217;t MSSQL just have a f-ing DATE field? (Others do&#8230; ) 😉</p>
						<small class="commentmetadata"><a href="#comment-92" title="">30 July 2008, 12:23 pm</a></small>
					</li>

	
	
		<li class="alt" id="comment-93">
			<h4>andrew says:</h4>
			<p>Thankyou very much for this, ive been trying to do this for the past hour !!</p>
						<small class="commentmetadata"><a href="#comment-93" title="">22 August 2008, 6:45 am</a></small>
					</li>

	
	
		<li class="" id="comment-96">
			<h4>Aidan says:</h4>
			<p>The other way that i use when trying to match up Date&#8217;s is to use the DATEPART funciton.</p>
<p>Select *<br>
from Test AS T<br>
WHERE DATEPART(DY, T.DateValue)  = DATEPART(DY, GETDATE())<br>
AND DATEPART(YY, T.DateValue) = DATEPART(YY, GETDATE())</p>
<p>The DY paramters returns the Day of Year. This has the advantage that you can store this value in a table if you need to (although it requires 2 fields).</p>
<p>If you just need to test for equality, however, its probably easier to use the DATEDIFF function that was mentioned above.</p>
						<small class="commentmetadata"><a href="#comment-96" title="">21 October 2008, 9:41 pm</a></small>
					</li>

	
	
		<li class="alt" id="comment-102">
			<h4>Rich says:</h4>
			<p>Thankyou!&nbsp;&nbsp;This is the best article about date manipulation I have ever read and very true to life.&nbsp;&nbsp;Whoever wrote this deserves a medal!</p>
						<small class="commentmetadata"><a href="#comment-102" title="">30 January 2009, 10:20 am</a></small>
					</li>

	
	
		<li class="" id="comment-103">
			<h4>Ryan says:</h4>
			<p>Another cool way a friend showed me of doing this is &#8230;</p>
<p>SELECT CONVERT(DATETIME,CONVERT(VARCHAR(12), GETDATE(), 105))</p>
<p>&#8230; I think you can get the different codes (e.g. 105) in the msdn cast/convert section.</p>
<p>I like the first solution though. Shows how many tricks can be learned in sql 🙂</p>
						<small class="commentmetadata"><a href="#comment-103" title="">11 February 2009, 4:46 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-98">
			<h4>Ting says:</h4>
			<p>Great aritcle! That&apos;s exactly I was looking for!</p>
<p>Thanks! 🙂</p>
						<small class="commentmetadata"><a href="#comment-98" title="">8 May 2009, 1:54 pm</a></small>
					</li>

	
	
		<li class="" id="comment-99">
			<h4>Justin Schier says:</h4>
			<p>I made a function that I use called WholeDay() so you can just wrap any date in WholeDay(DATE_COLUMN). This is SQL Server, and I always have to use dbo.WholeDay(DATE_COLUMN)</p>
<p>Here&apos;s the function:</p>
<p>/****** Object:&nbsp;&nbsp;UserDefinedFunction [dbo].[WholeDay]&nbsp;&nbsp;&nbsp;&nbsp;Script Date: 05/10/2009 11:55:50 ******/<br>
SET ANSI_NULLS ON<br>
GO<br>
SET QUOTED_IDENTIFIER ON<br>
GO<br>
&#8212; =============================================<br>
&#8212; Author:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Justin Schier<br>
&#8212; Create date: 4/9/2008<br>
&#8212; Description:&nbsp;&nbsp;&nbsp;&nbsp;Drops Time from DateTime<br>
&#8212; =============================================<br>
CREATE FUNCTION [dbo].[WholeDay]<br>
(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&#8212; Add the parameters for the function here<br>
&nbsp;&nbsp;&nbsp;&nbsp;@p1 datetime<br>
)<br>
RETURNS datetime<br>
AS<br>
BEGIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&#8212; Declare the return variable here<br>
&nbsp;&nbsp;&nbsp;&nbsp;DECLARE @Result datetime</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&#8212; Add the T-SQL statements to compute the return value here<br>
&nbsp;&nbsp;&nbsp;&nbsp;SELECT @Result = CAST(FLOOR(CAST(@p1 AS FLOAT)) AS DATETIME)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&#8212; Return the result of the function<br>
&nbsp;&nbsp;&nbsp;&nbsp;RETURN @Result</p>
<p>END</p>
						<small class="commentmetadata"><a href="#comment-99" title="">10 May 2009, 1:57 pm</a></small>
					</li>

	
	
		<li class="alt" id="comment-100">
			<h4>Justin Schier says:</h4>
			<p>In the above code, the dashes should be double dashes. This website changed them to long dashes.</p>
						<small class="commentmetadata"><a href="#comment-100" title="">10 May 2009, 1:58 pm</a></small>
					</li>

	
	
		<li class="" id="comment-94">
			<h4>john persona says:</h4>
			<p>great article, but it does not explain how to get only time portion from full date.</p>
						<small class="commentmetadata"><a href="#comment-94" title="">12 May 2009, 1:38 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-97">
			<h4>
<a href="http://www.jibben.com/" rel="external nofollow ugc" class="url">Scott Jibben</a> says:</h4>
			<p>If you want just the time portion from a datetime column, read the information on the CONVERT() function in the docs for more info.</p>
<p>(12 hour)</p>
<p>SELECT CONVERT(varchar(12), myDateField, 8) FROM myTable;</p>
<p>or (24 hour)</p>
<p>SELECT CONVERT(varchar(12), myDateField, 14) FROM myTable;</p>
						<small class="commentmetadata"><a href="#comment-97" title="">4 June 2009, 3:16 pm</a></small>
					</li>

	
	
		<li class="" id="comment-101">
			<h4>
<a href="http://www.jibben.com/" rel="external nofollow ugc" class="url">Scott Jibben</a> says:</h4>
			<p>This web editor converted the 8, followed by a right parenthesis into a smiley face&#8230;</p>
						<small class="commentmetadata"><a href="#comment-101" title="">4 June 2009, 3:18 pm</a></small>
					</li>

	
	
		<li class="alt" id="comment-95">
			<h4>Marianne says:</h4>
			<p>Thank you! This was exactly what I needed 🙂</p>
						<small class="commentmetadata"><a href="#comment-95" title="">9 June 2009, 2:31 pm</a></small>
					</li>

	
	
		<li class="" id="comment-588">
			<h4>Blerta says:</h4>
			<p>Great article and big help. Thank you!</p>
						<small class="commentmetadata"><a href="#comment-588" title="">31 July 2009, 5:52 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-685">
			<h4>Claes says:</h4>
			<p>If you compare two datetime fields in this way, the cast back to datetime should not be necessary. This saves some execution time.</p>
						<small class="commentmetadata"><a href="#comment-685" title="">25 August 2009, 3:13 am</a></small>
					</li>

	
	
		<li class="" id="comment-1565">
			<h4>Manoj says:</h4>
			<p>can we able to compare two dates by using if condition</p>
						<small class="commentmetadata"><a href="#comment-1565" title="">25 July 2010, 8:00 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-2182">
			<h4>Faheem Ahmad says:</h4>
			<p>Great article.<br>
I tested with following example and it really works for me.</p>
<p>DECLARE @d1 SMALLDATETIME<br>
DECLARE @d2 SMALLDATETIME</p>
<p>SET @d1 = (SELECT CAST(FLOOR(CAST( GETUTCDATE() AS float)) AS datetime))<br>
SET @d2 = (SELECT CAST(FLOOR(CAST( GETDATE() AS float)) AS datetime))</p>
<p>&#8211;PRINT @d3<br>
&#8211;PRINT @d4</p>
<p>IF(@d1 = @d2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;PRINT &apos;both dates are equal&apos;<br>
ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;PRINT &apos;no both dates are different&apos;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Thanks dude.</p>
						<small class="commentmetadata"><a href="#comment-2182" title="">12 April 2011, 2:00 am</a></small>
					</li>

	
	
		<li class="" id="comment-2185">
			<h4>Javier says:</h4>
			<p>This is the best way by far:</p>
<p>DateAdd(day, datediff(day,0, MydateValue), 0) </p>
<p>See the complete article on : <a href="http://stackoverflow.com/questions/353014/convert-sql-server-datetime-fields-to-compare-date-parts-only-with-indexed-looku" rel="nofollow ugc">http://stackoverflow.com/questions/353014/convert-sql-server-datetime-fields-to-compare-date-parts-only-with-indexed-looku</a></p>
						<small class="commentmetadata"><a href="#comment-2185" title="">12 April 2011, 3:43 pm</a></small>
					</li>

	
	
		<li class="alt" id="comment-2530">
			<h4>Ankur says:</h4>
			<p>SELECT * FROM TableName WHERE DATEPART(DY,Date) = DATEPART(DY,@date)</p>
						<small class="commentmetadata"><a href="#comment-2530" title="">24 September 2011, 7:09 am</a></small>
					</li>

	
	
		<li class="" id="comment-2597">
			<h4>
<a href="http://www.kennyclement.com/" rel="external nofollow ugc" class="url">kenny</a> says:</h4>
			<p>What&#8217;s wrong with:<br>
select cast(datetimefield as date) ?</p>
<p>Why go the hard way?<br>
I tried it, and just casting to date type works, no floor, floats, .. involved..</p>
						<small class="commentmetadata"><a href="#comment-2597" title="">3 November 2011, 3:34 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-2598">
			<h4>Ryan says:</h4>
			<p>Kenny, thanks for the comment. The &#8216;date&#8217; type was only added in SQL Server 2008. In all the prior versions you&#8217;ll need to do some mangling to be able to compare just the date portion.</p>
						<small class="commentmetadata"><a href="#comment-2598" title="">3 November 2011, 6:15 am</a></small>
					</li>

	
	
		<li class="" id="comment-2859">
			<h4>
<a href="http://www.88ix.com/" rel="external nofollow ugc" class="url">dave</a> says:</h4>
			<p>Like Jose said&#8230; use datediff(day, logindate ,&#8217;2012/06/05&#8242; ) = 0</p>
<p>Query Optimizer can use index on date that way.</p>
						<small class="commentmetadata"><a href="#comment-2859" title="">20 June 2012, 10:13 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-2930">
			<h4>Rodger says:</h4>
			<p>WHERE CAST(expire_date AS DATE) &gt;= CAST(getdate() AS DATE)</p>
						<small class="commentmetadata"><a href="#comment-2930" title="">19 July 2012, 7:20 am</a></small>
					</li>

	
	
	</ol>

 
</div>

	
	</div>

	<div id="sidebar">
	<div>
		<ul>
			<li id="text-3" class="widget widget_text">			<div class="textwidget"><center><img style="border: 1px solid gray;" src="/wp-content/uploads/2012/06/ryan-headshot-1.jpg" alt="Ryan Stille"></center></div>
		</li>
<li id="pages-3" class="widget widget_pages">
<h2 class="widgettitle">Pages</h2>

			<ul>
				<li class="page_item page-item-228"><a href="/about/">About Me</a></li>
<li class="page_item page-item-35"><a href="/projects/">My Projects</a></li>
			</ul>

			</li>
<li id="categories-3" class="widget widget_categories">
<h2 class="widgettitle">Article Categories</h2>

			<ul>
					<li class="cat-item cat-item-3">
<a href="/category/ajax-javascript/">AJAX / JavaScript</a>
</li>
	<li class="cat-item cat-item-4">
<a href="/category/bluedragon/">BlueDragon</a>
</li>
	<li class="cat-item cat-item-5">
<a href="/category/book-reviews/">Book Reviews</a>
</li>
	<li class="cat-item cat-item-6">
<a href="/category/coldfusion/">ColdFusion</a>
</li>
	<li class="cat-item cat-item-16">
<a href="/category/css/">CSS</a>
</li>
	<li class="cat-item cat-item-7">
<a href="/category/flex/">Flex</a>
</li>
	<li class="cat-item cat-item-8">
<a href="/category/linux/">Linux</a>
</li>
	<li class="cat-item cat-item-9">
<a href="/category/misc/">Misc</a>
</li>
	<li class="cat-item cat-item-10">
<a href="/category/railo/">Railo</a>
</li>
	<li class="cat-item cat-item-11">
<a href="/category/sql/">SQL</a>
</li>
	<li class="cat-item cat-item-12">
<a href="/category/system-administration/">System Administration</a>
</li>
	<li class="cat-item cat-item-13">
<a href="/category/tomcat/">Tomcat</a>
</li>
	<li class="cat-item cat-item-1">
<a href="/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-14">
<a href="/category/web-development/">Web Development</a>
</li>
			</ul>

			</li>

		<li id="recent-posts-3" class="widget widget_recent_entries">
		<h2 class="widgettitle">Recent Posts</h2>

		<ul>
											<li>
					<a href="/coldfusion-formfield-as-array-cf10/">Accessing form fields as an array in CF10</a>
									</li>
											<li>
					<a href="/onerror-img-image-tag/">Did you know about the onerror attribute of the img tag?</a>
									</li>
											<li>
					<a href="/copying-sql-studio-excel-headers/">Copying data from SQL Studio to Excel</a>
									</li>
											<li>
					<a href="/dateconvert-utc-not-what-you-expect/">Using DateConvert to get a UTC timestamp may not return what you expect</a>
									</li>
											<li>
					<a href="/get-filename-before-calling-cffile/">Getting the client filename before using cffile</a>
									</li>
											<li>
					<a href="/jquery-snippet-to-get-all-input-values/">jQuery snippet to get all input values</a>
									</li>
											<li>
					<a href="/mura-404-page-not-working-in-iis7-fix-it-in-web-config/">Mura 404 page not working in IIS7 &#8211; fix it in web.config</a>
									</li>
											<li>
					<a href="/free-coldfusion-10-beta-hosting/">Free ColdFusion 10 beta hosting</a>
									</li>
											<li>
					<a href="/remove-spaces-columns-cfspreadsheet/">Removing spaces from columns in cfspreadsheet (or any query)</a>
									</li>
											<li>
					<a href="/online-code-formatters/">Online code formatters</a>
									</li>
											<li>
					<a href="/joining-two-tables-one-id/">Joining to one of two tables with one ID</a>
									</li>
											<li>
					<a href="/formatting-cfgrid-with-javascript/">Formatting CFGRID with JavaScript</a>
									</li>
											<li>
					<a href="/cf-form-array-comma-workaround/">Accessing ColdFusion form values as an array</a>
									</li>
											<li>
					<a href="/loading-fckeditor-dynamically/">Loading CFrichtext / FCKeditor on-the-fly</a>
									</li>
											<li>
					<a href="/url-rewriting-windows-2008-iis7/">Mura URL rewriting on Windows 2008 / IIS7</a>
									</li>
					</ul>

		</li>
<li id="linkcat-2" class="widget widget_links">
<h2 class="widgettitle">Blogroll</h2>

	<ul class="xoxo blogroll">
<li><a href="http://www.axelscript.com/" title="AxelScript &#8211; Flex development blog">Axel Jensen</a></li>
<li><a href="http://jake.cfwebtools.com/" title="ColdFusion/Flex development">Jake Churchill</a></li>
<li><a href="http://www.coldfusionmuse.com/" title="ColdFusion Muse">Mark Kruger</a></li>
<li><a href="http://www.henke.ws/" title="ColdFusion, TDD, Ant, Subversion, etc.">Mike Henke</a></li>

	</ul>
</li>

<li id="text-4" class="widget widget_text">
<h2 class="widgettitle">Donate</h2>
			<div class="textwidget">If my code has helped you and you'd like give a donation, you can do so using the button below.
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_donations">
<input type="hidden" name="business" value="ryan@stillnet.org">
<input type="hidden" name="lc" value="US">
<input type="hidden" name="item_name" value="Donation for helpful ColdFusion code">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="bn" value="PP-DonationsBF:btn_donateCC_LG.gif:NonHostedGuest">
<input type="image" src="https://www.paypal.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
</div>
		</li>
<li id="text-5" class="widget widget_text">			<div class="textwidget">
<br><br>
<img src="/wp-content/uploads/2010/01/acp_logo.gif">
</div>
		</li>
			
		</ul> 
	</div>
	</div>
</div> <!-- wrapper -->

<div id="footer"><div><div><div>

	<a href="/feed/">Entries (RSS)</a> and <a href="/comments/feed/">Comments (RSS)</a>. Valid <a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional"><abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a> and <a href="http://jigsaw.w3.org/css-validator/check/referer"><abbr title="Cascading Style Sheets">CSS</abbr></a>.<br>

	Powered by <a href="http://www.wpthemes360.com/">Wordpress Themes</a>. Theme <a href="http://srinig.com/wordpress-themes/evanescence/">Evanescence</a> by <a href="http://srinig.com/">Srini G</a>

	</div></div></div></div>

</div> <!-- page -->

</body>

</html>