<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Stillnet Studios  &raquo; Blog Archive   &raquo; SQL CASE statement with NULLs</title>

<meta name="generator" content="WordPress 6.1.1"> <!-- leave this for stats -->

<link rel="stylesheet" href="/wp-content/themes/evanescence-12/style.css" type="text/css" media="screen">
<link rel="alternate" type="application/rss+xml" title="Stillnet Studios RSS Feed" href="/feed/">
<link rel="pingback" href="/xmlrpc.php">

<meta name="robots" content="max-image-preview:large">
				
	<script type="text/javascript">//<![CDATA[
	// Google Analytics for WordPress by Yoast v4.2.3 | http://yoast.com/wordpress/google-analytics/
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount','UA-1413191-1']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
	//]]></script>
<link rel="alternate" type="application/rss+xml" title="Stillnet Studios &raquo; SQL CASE statement with NULLs Comments Feed" href="/mssql-case-statement-with-nulls/feed/">
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"httpwww.stillnetstudios.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.1.1"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(p&&p.fillText)switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style>
	<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.1.1" type="text/css" media="all">
<link rel="stylesheet" id="classic-theme-styles-css" href="/wp-includes/css/classic-themes.min.css?ver=1" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}</style>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/99">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress 6.1.1">
<link rel="canonical" href="/mssql-case-statement-with-nulls/comment-page-1/#comments">
<link rel="shortlink" href="/?p=99">
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Fmssql-case-statement-with-nulls%2F">
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Fmssql-case-statement-with-nulls%2F&#038;format=xml">
</head>

<body>
<div id="page">

<div id="header">
<div><div>	
	<div class="header-title">
		<h1><a href="/" title="Stillnet Studios: Web development notes and commentary from Ryan Stille">Stillnet Studios</a></h1>
		<p>Web development notes and commentary from Ryan Stille</p>
	</div> 
	<!-- Search box (If you prefer having search form as a sidebar widget, remove this block) -->
	<div class="search">
		<form method="get" id="searchform" action="http://www.stillnetstudios.com/">
<input type="text" size="12" name="s" id="s" value="search..." onblur="if(this.value=='') this.value='search...';" onfocus="if(this.value=='search...') this.value='';">
</form>
	</div> 
	<!-- Search ends here-->
</div></div>	
</div>
<div id="wrapper">

	<div id="content">

			
		<div class="navigation">
			<div class="alignleft">&laquo; <a href="/maintaining-state-between-servers/" rel="prev">Using CFID and CFToken to jump between ColdFusion servers</a>
</div>
			<div class="alignright">
<a href="/require-subversion-comments-minimum/" rel="next">Require subversion comments &#8211; a perl pre-commit hook</a> &raquo;</div>
		</div>

		<div class="post" id="post-99">
			<div class="post-title"><div>
				<h2><a href="/mssql-case-statement-with-nulls/" rel="bookmark" title="Permanent Link to SQL CASE statement with NULLs">SQL CASE statement with NULLs</a></h2>
			</div></div>
			<div class="post-entry">
				<p>I&#8217;ve used this trick several times when needing to sort data into groups.  For example say you need to sort car classified listings by price.  Some of the dealers enter a price of &#8220;0&#8221; for their listings.   When sorting by lowest price, you want the listings that actually have a low price to come first, rather than than the cars costing $0 (hey, I&#8217;d like to buy your free car, thank you).<br>
<span id="more-99"></span></p>
<pre><code>SELECT year, make, model, price,
tmpSortPriceField =
    CASE price
        WHEN 0 THEN 2
        ELSE 1
    END
from cars ORDER BY tmpSortPriceField, price</code></pre>
<p>But I ran into a problem when some of the records had a NULL price.  They were getting a tmpSortPriceField value of 1, because they hit the &#8220;ELSE 1&#8221; part, thus were getting sorted up front.  So I added a line in the CASE statement for the NULL values:</p>
<pre><code>SELECT year, make, model, price,
tmpSortPriceField =
    CASE price
        WHEN 0 THEN 2
        <i>WHEN NULL THEN 2</i>
        ELSE 1
    END
from cars ORDER BY tmpSortPriceField, price</code></pre>
<p>But that didn&#8217;t work, the records with a null price were still getting a tmpSortPriceField value of 1.  I tried using IS NULL and that help either.  I don&#8217;t know why but my null comparison just wasn&#8217;t working.  I finally solved it by changing from the <em>simple case</em> form to the <em>searched case</em> form, where each entry in the case statement is compared for a boolean condition.</p>
<pre><code>SELECT year, make, model, price,
tmpSortPriceField =
    CASE
        WHEN price = 0 THEN 2
        WHEN price IS NULL THEN 2
        ELSE 1
    END
from cars ORDER BY tmpSortPriceField, price</code></pre>
<p>I don&#8217;t know exactly why this works better, but it does seem to handle the NULLs appropriately.  I&#8217;ve also heard from a nearby SQL guru that he always gets better results with the searched case statement, too.</p>
<p>Update &#8211; <a href="http://www.coldfusionmuse.com/">Mark Kruger</a> suggested using IsNull may work as well. I tested it, and it does work, but only in SQL Server.  So far the code above will work in MSSQL or MySQL.  Using IsNull() will break in MySQL because the IsNull() function in MySQL is different than the one in MSSQL.  But here is how you would do it using IsNull() in SQL Server:</p>
<pre><code>SELECT year, make, model, price,
tmpSortPriceField =
    CASE <em>IsNull</em>(price,0)
        WHEN 0 THEN 2
        ELSE 1
    END
from cars ORDER BY tmpSortPriceField, price</code></pre>
<p>Update 2 &#8211; <em>BUT</em>, I believe using COALESCE() would work in either MySQL or MSSQL:</p>
<pre><code>SELECT year, make, model, price,
tmpSortPriceField =
    CASE <em>COALESCE</em>(price,0)
        WHEN 0 THEN 2
        ELSE 1
    END
from cars ORDER BY tmpSortPriceField, price</code></pre>
							</div>
	
			<p class="post-meta">
					This entry was posted on 4 June 2008 at 2:05 pm					and is filed under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.
					You can follow any responses to this entry through the <a href="/mssql-case-statement-with-nulls/feed/">RSS 2.0</a> feed.

											Both comments and pings are currently closed.

					
			</p>
		</div>
	
<!-- You can start editing here. -->
<div id="comments">
	<h3>16 Comments</h3>

	<ol class="commentlist">

	
		<li class="alt" id="comment-380">
			<h4>
<a href="http://blog.pengoworks.com/" rel="external nofollow ugc" class="url">Dan G. Switzer, II</a> says:</h4>
			<p>The reason the first example doesn&#8217;t work is because NULL is never equal (=) to another value&#8211;even NULL = NULL will return false.</p>
<p>So you in your first example/attempt the code is essentially saying &#8220;WHERE price = NULL&#8221;, which will always fail. The reason the second example works is because you&#8217;re now using the correct expression for testing to see if a value is NULL&#8211;which is using the IS operator.</p>
<p>Obviously COALESCE works because if the value *is* NULL, it&#8217;s changing the value to 0.</p>
						<small class="commentmetadata"><a href="#comment-380" title="">5 June 2008, 8:50 am</a></small>
					</li>

	
	
		<li class="" id="comment-381">
			<h4>Ciro Theodoro says:</h4>
			<p>Very usefull. I was facing the same problem when I found this article. Thanks for that 😉</p>
						<small class="commentmetadata"><a href="#comment-381" title="">15 August 2008, 9:48 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-383">
			<h4>
<a href="http://www.nowebsite.com/" rel="external nofollow ugc" class="url">Sanjay</a> says:</h4>
			<p>Good piece of information&#8230;..I had a confusion in writing a CASE statement with NULLS and this article solved that, Thanks</p>
						<small class="commentmetadata"><a href="#comment-383" title="">8 October 2008, 4:04 am</a></small>
					</li>

	
	
		<li class="" id="comment-384">
			<h4>Jason says:</h4>
			<p>Very useful to me as well. I&#8217;m glad that I was able to stumble upon this.</p>
						<small class="commentmetadata"><a href="#comment-384" title="">9 December 2008, 12:46 pm</a></small>
					</li>

	
	
		<li class="alt" id="comment-382">
			<h4>Mmark says:</h4>
			<p>One more thnak you. It was a big helping.</p>
						<small class="commentmetadata"><a href="#comment-382" title="">18 February 2009, 9:39 pm</a></small>
					</li>

	
	
		<li class="" id="comment-724">
			<h4>Nayha says:</h4>
			<p>very helpful. Thanks.</p>
						<small class="commentmetadata"><a href="#comment-724" title="">15 September 2009, 5:18 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-1249">
			<h4>Patel Pinakin says:</h4>
			<p>was just forgot the syntax,<br>
thanx<br>
u helped me recall&#8230;</p>
<p>keep posting&#8230;</p>
						<small class="commentmetadata"><a href="#comment-1249" title="">3 April 2010, 1:08 am</a></small>
					</li>

	
	
		<li class="" id="comment-1673">
			<h4>
<a href="/mssql-case-statement-with-nulls/" rel="external nofollow ugc" class="url">Priya</a> says:</h4>
			<p>I have a similar issue. I do not wanna display the NULL records hitting the<br>
else part.For eg .I tried out methods like </p>
<p>Select NAME, EMPID,<br>
case<br>
when ( LOCATION like &apos;chennai&apos; or LOCATION like &apos;coimbatore&apos;)<br>
then &apos;Tamil Nadu&apos;<br>
when ( LOCATION like &apos;cochin&apos; or LOCATION like &apos;Trivandrum&apos;)<br>
then &apos;Kerala&apos;<br>
else<br>
end STATE<br>
from biodata where EMPID in ( select EMPID from biodata)<br>
and STATE is not null;</p>
<p>But iam getting displayed with null STATE records. Please help.</p>
						<small class="commentmetadata"><a href="#comment-1673" title="">7 September 2010, 6:55 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-1674">
			<h4>
<a href="/mssql-case-statement-with-nulls/" rel="external nofollow ugc" class="url">Priya</a> says:</h4>
			<p>The output would be like,</p>
<p>NAME&nbsp;&nbsp;&nbsp;&nbsp;EMPID&nbsp;&nbsp;&nbsp;&nbsp;STATE<br>
Tom&nbsp;&nbsp;&nbsp;&nbsp;12546&nbsp;&nbsp;&nbsp;&nbsp;Tamil Nadu<br>
Amy&nbsp;&nbsp;&nbsp;&nbsp;14645&nbsp;&nbsp;&nbsp;&nbsp;Kerala<br>
Katie&nbsp;&nbsp;&nbsp;&nbsp;24645&nbsp;&nbsp;&nbsp;&nbsp;<br>
Ravesh&nbsp;&nbsp;&nbsp;&nbsp;54654&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>I need only not null state records.Please do the needful. Iam facing the issue in my project</p>
						<small class="commentmetadata"><a href="#comment-1674" title="">7 September 2010, 7:51 am</a></small>
					</li>

	
	
		<li class="" id="comment-1864">
			<h4>stelban says:</h4>
			<p>Nice trick using nulls with case statement.&nbsp;&nbsp;Very helpful!&nbsp;&nbsp;Thanks</p>
						<small class="commentmetadata"><a href="#comment-1864" title="">29 October 2010, 11:46 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-1987">
			<h4>
<a href="http://none/" rel="external nofollow ugc" class="url">kumar</a> says:</h4>
			<p>use ISNULL(columnName,&lt;What ever you want if the value is NULL&gt;)</p>
<p>Hope this helps&#8230;</p>
						<small class="commentmetadata"><a href="#comment-1987" title="">22 December 2010, 9:52 am</a></small>
					</li>

	
	
		<li class="" id="comment-2025">
			<h4>
<a href="/mssql-case-statement-with-nulls/" rel="external nofollow ugc" class="url">Priya</a> says:</h4>
			<p>Hi Stelban and Kumar,<br>
@ Kumar : Actually, I was in need of not null records.</p>
<p>I have resolved the issue in a simple way by just putting my query in a new select statement. </p>
<p>select * from (Select NAME, EMPID,<br>
case<br>
when ( LOCATION like &apos;chennai&apos; or LOCATION like &apos;coimbatore&apos;)<br>
then &apos;Tamil Nadu&apos;<br>
when ( LOCATION like &apos;cochin&apos; or LOCATION like &apos;Trivandrum&apos;)<br>
then &apos;Kerala&apos;<br>
else<br>
end STATE<br>
from biodata where EMPID in ( select EMPID from biodata))<br>
where STATE is not null;</p>
<p>This gives the o/p<br>
NAME&nbsp;&nbsp;&nbsp;&nbsp;EMPID&nbsp;&nbsp;&nbsp;&nbsp;STATE<br>
Tom&nbsp;&nbsp;&nbsp;&nbsp;12546&nbsp;&nbsp;&nbsp;&nbsp;Tamil Nadu<br>
Amy&nbsp;&nbsp;&nbsp;&nbsp;14645&nbsp;&nbsp;&nbsp;&nbsp;Kerala<br>
 rather than</p>
<p>The output would be like,</p>
<p>NAME&nbsp;&nbsp;&nbsp;&nbsp;EMPID&nbsp;&nbsp;&nbsp;&nbsp;STATE<br>
Tom&nbsp;&nbsp;&nbsp;&nbsp;12546&nbsp;&nbsp;&nbsp;&nbsp;Tamil Nadu<br>
Amy&nbsp;&nbsp;&nbsp;&nbsp;14645&nbsp;&nbsp;&nbsp;&nbsp;Kerala<br>
Katie&nbsp;&nbsp;&nbsp;&nbsp;24645&nbsp;&nbsp;&nbsp;&nbsp;<br>
Ravesh&nbsp;&nbsp;&nbsp;&nbsp;54654</p>
<p>Hope this helps !!</p>
						<small class="commentmetadata"><a href="#comment-2025" title="">31 January 2011, 6:11 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-2595">
			<h4>
<a href="http://usman-suglatwala.blogspot.com/" rel="external nofollow ugc" class="url">Usman</a> says:</h4>
			<p>Thanks Buddy. Helped me to get those NULL variables to accept values! My blog on that here:<br>
<a href="http://usman-suglatwala.blogspot.com/2011/11/handling-nulls-in-sql-while-inserting.html" rel="nofollow ugc">http://usman-suglatwala.blogspot.com/2011/11/handling-nulls-in-sql-while-inserting.html</a></p>
						<small class="commentmetadata"><a href="#comment-2595" title="">2 November 2011, 10:45 am</a></small>
					</li>

	
	
		<li class="" id="comment-2686">
			<h4>Phil says:</h4>
			<p>Thanks for this, I was having trouble with NULL values but the &#8216;search&#8217; method of the CASE statement works just fine.</p>
						<small class="commentmetadata"><a href="#comment-2686" title="">1 February 2012, 4:14 am</a></small>
					</li>

	
	
		<li class="alt" id="comment-2808">
			<h4>James says:</h4>
			<p>The problem with sub selects is that they tend to slow everything down when working with large data sets.  I am currently having trouble with this where the nulls will be sorted out properly if I put the statement in the where clause but I cannot change the value via a case statement in the select clause using all the methods mentioned above and then some.</p>
						<small class="commentmetadata"><a href="#comment-2808" title="">29 April 2012, 8:21 pm</a></small>
					</li>

	
	
		<li class="" id="comment-2943">
			<h4>Ici says:</h4>
			<p>Many thanks</p>
						<small class="commentmetadata"><a href="#comment-2943" title="">20 September 2012, 5:44 am</a></small>
					</li>

	
	
	</ol>

 
</div>

	
	</div>

	<div id="sidebar">
	<div>
		<ul>
			<li id="text-3" class="widget widget_text">			<div class="textwidget"><center><img style="border: 1px solid gray;" src="/wp-content/uploads/2012/06/ryan-headshot-1.jpg" alt="Ryan Stille"></center></div>
		</li>
<li id="pages-3" class="widget widget_pages">
<h2 class="widgettitle">Pages</h2>

			<ul>
				<li class="page_item page-item-228"><a href="/about/">About Me</a></li>
<li class="page_item page-item-35"><a href="/projects/">My Projects</a></li>
			</ul>

			</li>
<li id="categories-3" class="widget widget_categories">
<h2 class="widgettitle">Article Categories</h2>

			<ul>
					<li class="cat-item cat-item-3">
<a href="/category/ajax-javascript/">AJAX / JavaScript</a>
</li>
	<li class="cat-item cat-item-4">
<a href="/category/bluedragon/">BlueDragon</a>
</li>
	<li class="cat-item cat-item-5">
<a href="/category/book-reviews/">Book Reviews</a>
</li>
	<li class="cat-item cat-item-6">
<a href="/category/coldfusion/">ColdFusion</a>
</li>
	<li class="cat-item cat-item-16">
<a href="/category/css/">CSS</a>
</li>
	<li class="cat-item cat-item-7">
<a href="/category/flex/">Flex</a>
</li>
	<li class="cat-item cat-item-8">
<a href="/category/linux/">Linux</a>
</li>
	<li class="cat-item cat-item-9">
<a href="/category/misc/">Misc</a>
</li>
	<li class="cat-item cat-item-10">
<a href="/category/railo/">Railo</a>
</li>
	<li class="cat-item cat-item-11">
<a href="/category/sql/">SQL</a>
</li>
	<li class="cat-item cat-item-12">
<a href="/category/system-administration/">System Administration</a>
</li>
	<li class="cat-item cat-item-13">
<a href="/category/tomcat/">Tomcat</a>
</li>
	<li class="cat-item cat-item-1">
<a href="/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-14">
<a href="/category/web-development/">Web Development</a>
</li>
			</ul>

			</li>

		<li id="recent-posts-3" class="widget widget_recent_entries">
		<h2 class="widgettitle">Recent Posts</h2>

		<ul>
											<li>
					<a href="/coldfusion-formfield-as-array-cf10/">Accessing form fields as an array in CF10</a>
									</li>
											<li>
					<a href="/onerror-img-image-tag/">Did you know about the onerror attribute of the img tag?</a>
									</li>
											<li>
					<a href="/copying-sql-studio-excel-headers/">Copying data from SQL Studio to Excel</a>
									</li>
											<li>
					<a href="/dateconvert-utc-not-what-you-expect/">Using DateConvert to get a UTC timestamp may not return what you expect</a>
									</li>
											<li>
					<a href="/get-filename-before-calling-cffile/">Getting the client filename before using cffile</a>
									</li>
											<li>
					<a href="/jquery-snippet-to-get-all-input-values/">jQuery snippet to get all input values</a>
									</li>
											<li>
					<a href="/mura-404-page-not-working-in-iis7-fix-it-in-web-config/">Mura 404 page not working in IIS7 &#8211; fix it in web.config</a>
									</li>
											<li>
					<a href="/free-coldfusion-10-beta-hosting/">Free ColdFusion 10 beta hosting</a>
									</li>
											<li>
					<a href="/remove-spaces-columns-cfspreadsheet/">Removing spaces from columns in cfspreadsheet (or any query)</a>
									</li>
											<li>
					<a href="/online-code-formatters/">Online code formatters</a>
									</li>
											<li>
					<a href="/joining-two-tables-one-id/">Joining to one of two tables with one ID</a>
									</li>
											<li>
					<a href="/formatting-cfgrid-with-javascript/">Formatting CFGRID with JavaScript</a>
									</li>
											<li>
					<a href="/cf-form-array-comma-workaround/">Accessing ColdFusion form values as an array</a>
									</li>
											<li>
					<a href="/loading-fckeditor-dynamically/">Loading CFrichtext / FCKeditor on-the-fly</a>
									</li>
											<li>
					<a href="/url-rewriting-windows-2008-iis7/">Mura URL rewriting on Windows 2008 / IIS7</a>
									</li>
					</ul>

		</li>
<li id="linkcat-2" class="widget widget_links">
<h2 class="widgettitle">Blogroll</h2>

	<ul class="xoxo blogroll">
<li><a href="http://www.axelscript.com/" title="AxelScript &#8211; Flex development blog">Axel Jensen</a></li>
<li><a href="http://jake.cfwebtools.com/" title="ColdFusion/Flex development">Jake Churchill</a></li>
<li><a href="http://www.coldfusionmuse.com/" title="ColdFusion Muse">Mark Kruger</a></li>
<li><a href="http://www.henke.ws/" title="ColdFusion, TDD, Ant, Subversion, etc.">Mike Henke</a></li>

	</ul>
</li>

<li id="text-4" class="widget widget_text">
<h2 class="widgettitle">Donate</h2>
			<div class="textwidget">If my code has helped you and you'd like give a donation, you can do so using the button below.
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_donations">
<input type="hidden" name="business" value="ryan@stillnet.org">
<input type="hidden" name="lc" value="US">
<input type="hidden" name="item_name" value="Donation for helpful ColdFusion code">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="bn" value="PP-DonationsBF:btn_donateCC_LG.gif:NonHostedGuest">
<input type="image" src="https://www.paypal.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
</div>
		</li>
<li id="text-5" class="widget widget_text">			<div class="textwidget">
<br><br>
<img src="/wp-content/uploads/2010/01/acp_logo.gif">
</div>
		</li>
			
		</ul> 
	</div>
	</div>
</div> <!-- wrapper -->

<div id="footer"><div><div><div>

	<a href="/feed/">Entries (RSS)</a> and <a href="/comments/feed/">Comments (RSS)</a>. Valid <a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional"><abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a> and <a href="http://jigsaw.w3.org/css-validator/check/referer"><abbr title="Cascading Style Sheets">CSS</abbr></a>.<br>

	Powered by <a href="http://www.wpthemes360.com/">Wordpress Themes</a>. Theme <a href="http://srinig.com/wordpress-themes/evanescence/">Evanescence</a> by <a href="http://srinig.com/">Srini G</a>

	</div></div></div></div>

</div> <!-- page -->

</body>

</html>