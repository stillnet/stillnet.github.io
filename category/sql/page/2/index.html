<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Stillnet Studios   &raquo; SQL</title>

<meta name="generator" content="WordPress 6.1.1"> <!-- leave this for stats -->

<link rel="stylesheet" href="/wp-content/themes/evanescence-12/style.css" type="text/css" media="screen">
<link rel="alternate" type="application/rss+xml" title="Stillnet Studios RSS Feed" href="/feed/">
<link rel="pingback" href="/xmlrpc.php">

<meta name="robots" content="max-image-preview:large">
				
	<script type="text/javascript">//<![CDATA[
	// Google Analytics for WordPress by Yoast v4.2.3 | http://yoast.com/wordpress/google-analytics/
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount','UA-1413191-1']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
	//]]></script>
<link rel="alternate" type="application/rss+xml" title="Stillnet Studios &raquo; SQL Category Feed" href="/category/sql/feed/">
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"httpwww.stillnetstudios.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.1.1"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(p&&p.fillText)switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style>
	<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.1.1" type="text/css" media="all">
<link rel="stylesheet" id="classic-theme-styles-css" href="/wp-includes/css/classic-themes.min.css?ver=1" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}</style>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/categories/11">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress 6.1.1">
</head>

<body>
<div id="page">

<div id="header">
<div><div>	
	<div class="header-title">
		<h1><a href="/" title="Stillnet Studios: Web development notes and commentary from Ryan Stille">Stillnet Studios</a></h1>
		<p>Web development notes and commentary from Ryan Stille</p>
	</div> 
	<!-- Search box (If you prefer having search form as a sidebar widget, remove this block) -->
	<div class="search">
		<form method="get" id="searchform" action="http://www.stillnetstudios.com/">
<input type="text" size="12" name="s" id="s" value="search..." onblur="if(this.value=='') this.value='search...';" onfocus="if(this.value=='search...') this.value='';">
</form>
	</div> 
	<!-- Search ends here-->
</div></div>	
</div>
<div id="wrapper">

	<div id="content">
	
	 
		<h2 class="archive-title">Archive for the &#8216;SQL&#8217; Category</h2>

 	  

		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"><a href="/category/sql/">Next Entries &raquo;</a></div>
		</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-142"><a href="/finding-database-dupliates-jason-troy/" rel="bookmark" title="Permanent Link to Finding and deleting dupliates from a database table">Finding and deleting dupliates from a database table</a></h3>
				</div></div>

				<div class="post-entry">
					<p>My SQL savvy coworker Jason Troy has done some work recently on finding and deleting duplicate records in a database.  One of the things he had to do was compare on a <em>text </em>field (that is, over 8000 characters and not a varchar).  Very interesting.</p>
<p><a href="http://phillyun.blogspot.com/2008/10/power-of-sql-find-and-delete-duplicates.html">http://phillyun.blogspot.com/2008/10/power-of-sql-find-and-delete-duplicates.html</a></p>
				</div>

				<p class="post-meta">Posted by Ryan on October 14 2008 at 1:12 pm under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><span>Comments Off<span class="screen-reader-text"> on Finding and deleting dupliates from a database table</span></span>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-108"><a href="/problems-connecting-to-mysql-locally/" rel="bookmark" title="Permanent Link to Problems connecting to MySQL locally &#8211; try localhost instead of %">Problems connecting to MySQL locally &#8211; try localhost instead of %</a></h3>
				</div></div>

				<div class="post-entry">
					<p>I&#8217;m setting up mysql locally on my laptop this weekend, and ran into a snag that cost me at least an hour.  To mimic a web app I am running locally, I needed to connect to mysql with a specific username and password.  But no matter what I did, I always got this error:</p>
<pre><code>MySQL: access denied for user: <em>username</em> (Using password: YES)</code></pre>
<p>I got this when connecting via the command line client and via ColdFusion.  Finally after some googling I came across <a href="http://javafoo.wordpress.com/2005/06/30/mysql-access-denied-for-user-using-password-yes">this blog post</a> suggesting to change the privilege details to allow connecting from &#8216;localhost&#8217; instead of &#8216;%&#8217;.   The % indicates a wildcard and should allow connections from any host.  But for some reason this was not working for me.   Changing it to &#8216;localhost&#8217; fixed the problem and allowed me to connect.  I think it may have had something to do with the fact that I checked a box when installing that would only allow connections from the localhost.</p>
<p>I used this SQL to fix the host setting after connecting to the &#8216;mysql&#8217; database:</p>
<pre><code>update user set Host=’localhost’ where User=’myUserName’</code></pre>
				</div>

				<p class="post-meta">Posted by Ryan on August 24 2008 at 5:19 pm under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/system-administration/" rel="category tag">System Administration</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><a href="/problems-connecting-to-mysql-locally/#comments">2 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-99"><a href="/mssql-case-statement-with-nulls/" rel="bookmark" title="Permanent Link to SQL CASE statement with NULLs">SQL CASE statement with NULLs</a></h3>
				</div></div>

				<div class="post-entry">
					<p>I&#8217;ve used this trick several times when needing to sort data into groups.  For example say you need to sort car classified listings by price.  Some of the dealers enter a price of &#8220;0&#8221; for their listings.   When sorting by lowest price, you want the listings that actually have a low price to come first, rather than than the cars costing $0 (hey, I&#8217;d like to buy your free car, thank you).<br>
 <a href="/mssql-case-statement-with-nulls/#more-99" class="more-link"><small>Continue reading &#8216;SQL CASE statement with NULLs&#8217; &raquo;</small></a></p>
				</div>

				<p class="post-meta">Posted by Ryan on June 4 2008 at 2:05 pm under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><a href="/mssql-case-statement-with-nulls/#comments">16 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-97"><a href="/cleaning-up-orphaned-records-in-mysql/" rel="bookmark" title="Permanent Link to Cleaning up orphaned records in MySQL">Cleaning up orphaned records in MySQL</a></h3>
				</div></div>

				<div class="post-entry">
					<p>I needed to clean out some orphaned records from a MySQL database today.  I thought this would be as simple as</p>
<pre><code>DELETE FROM subTable WHERE ID IN (
  SELECT subTable.ID from subTable
  LEFT OUTER JOIN parentTable ON subTable.parentID = parentTable.ID
  WHERE  parentTable.ID IS NULL
  )</code></pre>
<p>But this resulted in an error:<br>
 <a href="/cleaning-up-orphaned-records-in-mysql/#more-97" class="more-link"><small>Continue reading &#8216;Cleaning up orphaned records in MySQL&#8217; &raquo;</small></a></p>
				</div>

				<p class="post-meta">Posted by Ryan on April 11 2008 at 1:44 pm under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><a href="/cleaning-up-orphaned-records-in-mysql/#comments">5 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-53"><a href="/case-sensitive-comparisons-in-sql/" rel="bookmark" title="Permanent Link to Case sensitive comparisons in SQL">Case sensitive comparisons in SQL</a></h3>
				</div></div>

				<div class="post-entry">
					<p>We had a need to do a case sensitive SQL comparison this week.  As part of a login process a user is prompted for an answer to their security question.  Now I really don&#8217;t think forcing users to enter their employer&#8217;s name in the exact case does anything to keep out hackers, but the client wanted it done this way.</p>
<p>Of course we could pull the values into ColdFusion and do a case sensitive comparison with Compare().  But the code was already setup to do the comparison at the SQL level, which is usually a better idea anyway if it can be done.</p>
<p>There are several ways to tell MS SQL to do a case sensitive comparison.  <a href="/case-sensitive-comparisons-in-sql/#more-53" class="more-link"><small>Continue reading &#8216;Case sensitive comparisons in SQL&#8217; &raquo;</small></a></p>
				</div>

				<p class="post-meta">Posted by Ryan on July 3 2007 at 9:53 am under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><a href="/case-sensitive-comparisons-in-sql/#comments">5 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-47"><a href="/union-queries-automatically-filter-duplicates/" rel="bookmark" title="Permanent Link to SQL &#8216;UNION&#8217; queries automatically filter out duplicates">SQL &#8216;UNION&#8217; queries automatically filter out duplicates</a></h3>
				</div></div>

				<div class="post-entry">
					<p>Did you know that in MS SQL and MySQL, a UNION query will automatically filter out duplicate records between the tables that are being unioned?</p>
<p>I ran into this on an email tool I was working on.  The client wanted to email users that had recently signed up for either of two different services.  So I did a UNION between the two tables to pull all the users into one query that I could loop through.  But for some reason, my test user that was in both tables (but with the same name and email address) was only showing up once.  I had expected to need to filter out duplicates myself, and I was puzzled as to why both users weren&#8217;t showing up.  Here is the query:<br>
 <a href="/union-queries-automatically-filter-duplicates/#more-47" class="more-link"><small>Continue reading &#8216;SQL &#8216;UNION&#8217; queries automatically filter out duplicates&#8217; &raquo;</small></a></p>
				</div>

				<p class="post-meta">Posted by Ryan on March 26 2007 at 1:19 pm under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><a href="/union-queries-automatically-filter-duplicates/#comments">3 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-42"><a href="/copying-data-into-other-tables-while-eliminating-duplicates/" rel="bookmark" title="Permanent Link to Copying data into other tables while eliminating duplicates">Copying data into other tables while eliminating duplicates</a></h3>
				</div></div>

				<div class="post-entry">
					<p>This week I had a need to copy some data between SQL Server database tables.  A client of ours has three tables containing users &#8211; subscribers, seminar users, and weekly report users.  He wanted his subscribers and seminar users to be placed into the weekly report table, along with modifying the subscriber and seminar signups to also insert those users into the weekly report users table.</p>
<p>Copying data between tables in SQL is pretty straightforward:</p>
<p><code>INSERT INTO reportUsers (fname, lname, email)<br>
SELECT fname, lname, email FROM seminarUsers</code></p>
<p>The problem with this is that some of the subscriber and seminar users already exist in the weekly report table.  We can exclude them with a subquery:</p>
<p><code>INSERT INTO reportUsers (fname, lname, email)<br>
SELECT fname, lname, email FROM seminarUsers<br>
<span style="color: red;">WHERE email NOT IN (select email FROM reportUsers)</span></code></p>
<p>But, the seminarUsers table contains signups for every seminar.  That means a given user could have signed for several seminars, and would be imported into the reportUsers table more than once.  To solve that we need to eliminate the duplicate records coming from the select statement.  But for a given email address, which of the several record should we choose to import?  On the second or third time the user signed up for a seminar, they may have given us an updated name or address.  Only the name is relevant in this example, but in actuality I was copying more fields than just the first and last name.  So lets grab the most recent signup.  We can do that by just using the record with the highest userid, since it&#8217;s an identity field &#8211; the more recent records will have a higher user id number. <a href="/copying-data-into-other-tables-while-eliminating-duplicates/#more-42" class="more-link"><small>Continue reading &#8216;Copying data into other tables while eliminating duplicates&#8217; &raquo;</small></a></p>
				</div>

				<p class="post-meta">Posted by Ryan on March 4 2007 at 4:19 pm under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><a href="/copying-data-into-other-tables-while-eliminating-duplicates/#comments">1 Comment</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-20"><a href="/comparing-dates-without-times-in-sql-server/" rel="bookmark" title="Permanent Link to Comparing dates without times in SQL Server">Comparing dates without times in SQL Server</a></h3>
				</div></div>

				<div class="post-entry">
					<p>Sometimes you have the need in an application to compare dates without the time component.  For example, a user signs up for a free 30-day trial of a client&#8217;s site.  The user&#8217;s &#8216;expire_date&#8217; will be set for 30 days from today, probably using something like DateAdd(&#8220;d&#8221;,30,getdate()).  At some point you need to compare the expire_date against the current date.  Maybe its a report of current free trial users, or a query to see if the user is allowed to login.  Your query will look something like</p>
<p><code>... WHERE expire_date &gt;= getdate()</code></p>
<p>The problem with this is that both values contain a time component.  What you are really comparing is something like</p>
<p><code>... WHERE <em>2007-1-20 10:44:22.717</em> &gt;= <em>2007-1-20 10:30:28.287</em></code></p>
<p>  So a user may be considered still in their free trial at 10:30am, but when they try to login again 20 minutes later, they may be told their trial has expired.  In reality the free trial should continue throughout the last day of the trial period.  If you signed up for a free two week gym membership, would you expect to be allowed in before lunch on the last day but not after because of what time you initially signed up?</p>
<p>This is not a problem in MySQL, as it has a simple DATE type (in addition to the common DATETIME type) that does not store any time data.  So what we need to do in SQL Server is strip off the time component.  I typically do this when I store the date, but you could do it at compare time, too.</p>
<p>SQL Server datetimes are stored internally as floating point numbers.  You can see this by CASTing the value of getdate to a float.</p>
<p><code>SELECT CAST( getdate() AS float)</code></p>
<p>When I ran this just now I got 39100.964272067904.  That indicates 39100 days after 1/1/1900 (SQL Server&#8217;s base date), and 96/100ths of a fractional day (it&#8217;s almost midnight).  We can use this to modify the float value and then CAST it back as a datetime type.  The FLOOR function will strip off any decimal portion of a number.  Thus:</p>
<p><code>SELECT CAST(FLOOR(CAST( getdate() AS float)) AS datetime)</code></p>
<p>returns &#8220;2007-01-20 00:00:00.000&#8221; &#8211; the date without the time.</p>
<p>There are other ways to do this, using the day, month and year functions or the CONVERT function.  I find the above method to be more straight forward  (although only by a little &#8211; its a pain no matter how you do it).  You could add that code to a trigger so whenever that field is set or updated the time portion is automatically stripped off.</p>
<p>Now when we compare the field, we&#8217;ll need to do the same conversion to the current day:</p>
<p><code>... WHERE expire_date &gt;= CAST(FLOOR(CAST( getdate() AS float)) AS datetime)</code></p>
<p>Keep in mind that queries with functions in the search condition are expensive.  If you are going to run this often or on a lot of data, you may want to pass in the date from your application language:</p>
<p><code>... WHERE expire_date &gt;= '2007-01-20'</code></p>
				</div>

				<p class="post-meta">Posted by Ryan on January 20 2007 at 11:51 pm under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><a href="/comparing-dates-without-times-in-sql-server/#comments">35 Comments</a>.   </p>

			</div>

		
		<div class="navigation">
			<div class="alignleft"></div>
			<div class="alignright"><a href="/category/sql/">Next Entries &raquo;</a></div>
		</div>

	
	</div>

	<div id="sidebar">
	<div>
		<ul>
			<li id="text-3" class="widget widget_text">			<div class="textwidget"><center><img style="border: 1px solid gray;" src="/wp-content/uploads/2012/06/ryan-headshot-1.jpg" alt="Ryan Stille"></center></div>
		</li>
<li id="pages-3" class="widget widget_pages">
<h2 class="widgettitle">Pages</h2>

			<ul>
				<li class="page_item page-item-228"><a href="/about/">About Me</a></li>
<li class="page_item page-item-35"><a href="/projects/">My Projects</a></li>
			</ul>

			</li>
<li id="categories-3" class="widget widget_categories">
<h2 class="widgettitle">Article Categories</h2>

			<ul>
					<li class="cat-item cat-item-3">
<a href="/category/ajax-javascript/">AJAX / JavaScript</a>
</li>
	<li class="cat-item cat-item-4">
<a href="/category/bluedragon/">BlueDragon</a>
</li>
	<li class="cat-item cat-item-5">
<a href="/category/book-reviews/">Book Reviews</a>
</li>
	<li class="cat-item cat-item-6">
<a href="/category/coldfusion/">ColdFusion</a>
</li>
	<li class="cat-item cat-item-16">
<a href="/category/css/">CSS</a>
</li>
	<li class="cat-item cat-item-7">
<a href="/category/flex/">Flex</a>
</li>
	<li class="cat-item cat-item-8">
<a href="/category/linux/">Linux</a>
</li>
	<li class="cat-item cat-item-9">
<a href="/category/misc/">Misc</a>
</li>
	<li class="cat-item cat-item-10">
<a href="/category/railo/">Railo</a>
</li>
	<li class="cat-item cat-item-11 current-cat">
<a aria-current="page" href="/category/sql/">SQL</a>
</li>
	<li class="cat-item cat-item-12">
<a href="/category/system-administration/">System Administration</a>
</li>
	<li class="cat-item cat-item-13">
<a href="/category/tomcat/">Tomcat</a>
</li>
	<li class="cat-item cat-item-1">
<a href="/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-14">
<a href="/category/web-development/">Web Development</a>
</li>
			</ul>

			</li>

		<li id="recent-posts-3" class="widget widget_recent_entries">
		<h2 class="widgettitle">Recent Posts</h2>

		<ul>
											<li>
					<a href="/coldfusion-formfield-as-array-cf10/">Accessing form fields as an array in CF10</a>
									</li>
											<li>
					<a href="/onerror-img-image-tag/">Did you know about the onerror attribute of the img tag?</a>
									</li>
											<li>
					<a href="/copying-sql-studio-excel-headers/">Copying data from SQL Studio to Excel</a>
									</li>
											<li>
					<a href="/dateconvert-utc-not-what-you-expect/">Using DateConvert to get a UTC timestamp may not return what you expect</a>
									</li>
											<li>
					<a href="/get-filename-before-calling-cffile/">Getting the client filename before using cffile</a>
									</li>
											<li>
					<a href="/jquery-snippet-to-get-all-input-values/">jQuery snippet to get all input values</a>
									</li>
											<li>
					<a href="/mura-404-page-not-working-in-iis7-fix-it-in-web-config/">Mura 404 page not working in IIS7 &#8211; fix it in web.config</a>
									</li>
											<li>
					<a href="/free-coldfusion-10-beta-hosting/">Free ColdFusion 10 beta hosting</a>
									</li>
											<li>
					<a href="/remove-spaces-columns-cfspreadsheet/">Removing spaces from columns in cfspreadsheet (or any query)</a>
									</li>
											<li>
					<a href="/online-code-formatters/">Online code formatters</a>
									</li>
											<li>
					<a href="/joining-two-tables-one-id/">Joining to one of two tables with one ID</a>
									</li>
											<li>
					<a href="/formatting-cfgrid-with-javascript/">Formatting CFGRID with JavaScript</a>
									</li>
											<li>
					<a href="/cf-form-array-comma-workaround/">Accessing ColdFusion form values as an array</a>
									</li>
											<li>
					<a href="/loading-fckeditor-dynamically/">Loading CFrichtext / FCKeditor on-the-fly</a>
									</li>
											<li>
					<a href="/url-rewriting-windows-2008-iis7/">Mura URL rewriting on Windows 2008 / IIS7</a>
									</li>
					</ul>

		</li>
<li id="linkcat-2" class="widget widget_links">
<h2 class="widgettitle">Blogroll</h2>

	<ul class="xoxo blogroll">
<li><a href="http://www.axelscript.com/" title="AxelScript &#8211; Flex development blog">Axel Jensen</a></li>
<li><a href="http://jake.cfwebtools.com/" title="ColdFusion/Flex development">Jake Churchill</a></li>
<li><a href="http://www.coldfusionmuse.com/" title="ColdFusion Muse">Mark Kruger</a></li>
<li><a href="http://www.henke.ws/" title="ColdFusion, TDD, Ant, Subversion, etc.">Mike Henke</a></li>

	</ul>
</li>

<li id="text-4" class="widget widget_text">
<h2 class="widgettitle">Donate</h2>
			<div class="textwidget">If my code has helped you and you'd like give a donation, you can do so using the button below.
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_donations">
<input type="hidden" name="business" value="ryan@stillnet.org">
<input type="hidden" name="lc" value="US">
<input type="hidden" name="item_name" value="Donation for helpful ColdFusion code">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="bn" value="PP-DonationsBF:btn_donateCC_LG.gif:NonHostedGuest">
<input type="image" src="https://www.paypal.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
</div>
		</li>
<li id="text-5" class="widget widget_text">			<div class="textwidget">
<br><br>
<img src="/wp-content/uploads/2010/01/acp_logo.gif">
</div>
		</li>
			
		</ul> 
	</div>
	</div>
</div> <!-- wrapper -->

<div id="footer"><div><div><div>

	<a href="/feed/">Entries (RSS)</a> and <a href="/comments/feed/">Comments (RSS)</a>. Valid <a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional"><abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a> and <a href="http://jigsaw.w3.org/css-validator/check/referer"><abbr title="Cascading Style Sheets">CSS</abbr></a>.<br>

	Powered by <a href="http://www.wpthemes360.com/">Wordpress Themes</a>. Theme <a href="http://srinig.com/wordpress-themes/evanescence/">Evanescence</a> by <a href="http://srinig.com/">Srini G</a>

	</div></div></div></div>

</div> <!-- page -->

</body>

</html>