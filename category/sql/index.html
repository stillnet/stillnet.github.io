<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Stillnet Studios   &raquo; SQL</title>

<meta name="generator" content="WordPress 6.1.1"> <!-- leave this for stats -->

<link rel="stylesheet" href="/wp-content/themes/evanescence-12/style.css" type="text/css" media="screen">
<link rel="alternate" type="application/rss+xml" title="Stillnet Studios RSS Feed" href="/feed/">
<link rel="pingback" href="/xmlrpc.php">

<meta name="robots" content="max-image-preview:large">
				
	<script type="text/javascript">//<![CDATA[
	// Google Analytics for WordPress by Yoast v4.2.3 | http://yoast.com/wordpress/google-analytics/
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount','UA-1413191-1']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
	//]]></script>
<link rel="alternate" type="application/rss+xml" title="Stillnet Studios &raquo; SQL Category Feed" href="/category/sql/feed/">
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"httpwww.stillnetstudios.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.1.1"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(p&&p.fillText)switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style>
	<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.1.1" type="text/css" media="all">
<link rel="stylesheet" id="classic-theme-styles-css" href="/wp-includes/css/classic-themes.min.css?ver=1" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}</style>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/categories/11">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml">
<meta name="generator" content="WordPress 6.1.1">
</head>

<body>
<div id="page">

<div id="header">
<div><div>	
	<div class="header-title">
		<h1><a href="/" title="Stillnet Studios: Web development notes and commentary from Ryan Stille">Stillnet Studios</a></h1>
		<p>Web development notes and commentary from Ryan Stille</p>
	</div> 
	<!-- Search box (If you prefer having search form as a sidebar widget, remove this block) -->
	<div class="search">
		<form method="get" id="searchform" action="http://www.stillnetstudios.com/">
<input type="text" size="12" name="s" id="s" value="search..." onblur="if(this.value=='') this.value='search...';" onfocus="if(this.value=='search...') this.value='';">
</form>
	</div> 
	<!-- Search ends here-->
</div></div>	
</div>
<div id="wrapper">

	<div id="content">
	
	 
		<h2 class="archive-title">Archive for the &#8216;SQL&#8217; Category</h2>

 	  

		<div class="navigation">
			<div class="alignleft"><a href="/category/sql/page/2/">&laquo; Previous Entries</a></div>
			<div class="alignright"></div>
		</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-1164"><a href="/copying-sql-studio-excel-headers/" rel="bookmark" title="Permanent Link to Copying data from SQL Studio to Excel">Copying data from SQL Studio to Excel</a></h3>
				</div></div>

				<div class="post-entry">
					<p>I often need to write ad-hoc reports in MS SQL Studio, and then provide those results in an Excel spreadsheet. This has usually been a little tedious, I copy &#038; paste the results from SQL Studio into Excel, then have to manually add column names to the Excel spreadsheet. So I finally spent some time figuring out how to do this better, and discovered that it is possible to have the column names come over automatically. I&#8217;m sure many of you already knew about this, but I didn&#8217;t so I thought it might be worth sharing. I had tried googling this in the past and didn&#8217;t come up with anything, so maybe it&#8217;s not widely known.<br>
 <a href="/copying-sql-studio-excel-headers/#more-1164" class="more-link"><small>Continue reading &#8216;Copying data from SQL Studio to Excel&#8217; &raquo;</small></a></p>
				</div>

				<p class="post-meta">Posted by Ryan on January 2 2013 at 9:14 am under <a href="/category/sql/" rel="category tag">SQL</a>.<br><a href="/copying-sql-studio-excel-headers/#comments">3 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-1086"><a href="/remove-spaces-columns-cfspreadsheet/" rel="bookmark" title="Permanent Link to Removing spaces from columns in cfspreadsheet (or any query)">Removing spaces from columns in cfspreadsheet (or any query)</a></h3>
				</div></div>

				<div class="post-entry">
					<p>I love the CFSPREADSHEET tag that was added to ColdFusion9. It makes working with spread sheet data so easy. The spreadsheets I am given to work with often contain descriptive column names that contain spaces like &#8220;First Name&#8221; or &#8220;Home Phone&#8221;. This causes a problem when you try to work with the data in a QoQ (query of a query).</p>
<p>Lets say you have a spread sheet containing these columns: Name, City, State, Postal Code. Then pull it into a query using the cfspreadsheet tag:<br>
<code>&lt;cfspreadsheet action="read" src="c:\Customers.xls" query="customers" headerrow="1" rows="2-65536" sheetname="Customers"&gt;</code></p>
<p>Now try to narrow down the results to only those in a certain postal code. This won&#8217;t work of course:<br>
<code>&lt;cfquery name="qryCA" dbtype="query"&gt;<br>
SELECT * FROM customers WHERE [Postal Code] = '90210'<br>
&lt;/cfquery&gt;</code></p>
<p>Neither will this:<br>
<code>&lt;cfquery name="qryCA" dbtype="query"&gt;<br>
SELECT * FROM customers WHERE [Postal\ Code] = '90210'<br>
&lt;/cfquery&gt;</code></p>
<p>Or this:<br>
<code>&lt;cfquery name="qryCA" dbtype="query"&gt;<br>
SELECT * FROM customers WHERE ['Postal Code'] = '90210'<br>
&lt;/cfquery&gt;</code></p>
<p>I have not found any way to escape a space in a column name inside QoQ. But, thankfully there is a way we can manipulate the column names to remove the space.</p>
<pre><code>&lt;cfset colNameArray = customers.getColumnNames() /&gt;
&lt;cfloop from="1" to="#arrayLen(colNameArray)#" index="i"&gt;
	&lt;cfset colNameArray[i] = colNameArray[i].replace(' ','') /&gt;
&lt;/cfloop&gt;
&lt;cfset customers.setColumnNames(colNameArray) /&gt;</code></pre>
<p>You could use this to completely rename column names if you wanted to. This isn&#8217;t just useful for working with cfspreadsheet either, I could see this being used in other circumstances to change the column names.</p>
<p>Thanks to <a href="http://www.neiland.net/blog/article/using-java-to-rename-columns-in-a-coldfusion-query-object/" title="Steven Neiland">Steven Neiland</a> for pointing me in this direction.</p>
				</div>

				<p class="post-meta">Posted by Ryan on October 16 2011 at 8:33 pm under <a href="/category/coldfusion/" rel="category tag">ColdFusion</a>, <a href="/category/sql/" rel="category tag">SQL</a>.<br><a href="/remove-spaces-columns-cfspreadsheet/#comments">3 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-1082"><a href="/online-code-formatters/" rel="bookmark" title="Permanent Link to Online code formatters">Online code formatters</a></h3>
				</div></div>

				<div class="post-entry">
					<p>Lately I&#8217;ve come across some online formatting tools that have been very helpful. I like these because they work regardless of what IDE you use, what operating system, etc. They work from any computer that has internet access. Handy when you are troubleshooting on a remote machine.</p>
<p>Here is one for formatting XML: <a href="http://www.shell-tools.net/index.php?op=xml_format">http://www.shell-tools.net/index.php?op=xml_format</a></p>
<p>And one for JSON from the same site: <a href="http://www.shell-tools.net/index.php?op=json_format">http://www.shell-tools.net/index.php?op=json_format</a></p>
<p>Here is a SQL one that helped me out a lot tonight: <a href="http://www.dpriver.com/pp/sqlformat.htm">http://www.dpriver.com/pp/sqlformat.htm</a></p>
<p>I fed it a horrible looking, very complex query and it made it easily readable. 🙂</p>
				</div>

				<p class="post-meta">Posted by Ryan on July 13 2011 at 7:53 pm under <a href="/category/ajax-javascript/" rel="category tag">AJAX / JavaScript</a>, <a href="/category/misc/" rel="category tag">Misc</a>, <a href="/category/sql/" rel="category tag">SQL</a>.<br><a href="/online-code-formatters/#comments">1 Comment</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-1061"><a href="/joining-two-tables-one-id/" rel="bookmark" title="Permanent Link to Joining to one of two tables with one ID">Joining to one of two tables with one ID</a></h3>
				</div></div>

				<div class="post-entry">
					<p>I came across an interesting problem the other day where I needed to join to either one of two different tables. Here is an example scenario:</p>
<p>Say you have an ecommerce site that your customers log into. Customers exist in a table named “customers”. When they place an order, an order record is created in the orders table.  There is a CreatorID field that indicates which customer placed the order. A common practice when creating order reports is to join the order to the customer in order to be able to display the customer contact information when displaying the order. </p>
<p><code>SELECT orders.*, customers.name FROM orders<br>
JOIN customers on orders.creator ID = customers.customerID</code></p>
<p>Later you are given the task of allowing vendors to place orders.  Vendors also log into your site but their accounts are stored in a separate vendors table. So now you are faced with the question of how to link orders to both the customers and vendors table. You could add a vendorID field to the orders table, then change your join to connect to both tables:</p>
<p><code>SELECT orders.*, customers.name AS customerName, vendors.name AS vendorName FROM orders<br>
LEFT JOIN customers on orders.creator ID = customers.customerID<br>
LEFT JOIN  vendors on orders.vendorID = vendors.vendor ID</code></p>
<p>The LEFT JOIN here is necessary so we still get an order record even when there is not a match in the customers or vendors table. The problem I had with this approach is it requires changing a lot of other code on the system. Because the “name” column is ambiguous between the two tables, we had to alias the “name” column to be different for each of the two tables. So now all your view code would have to be changed to look at one of those two columns.</p>
<p><code>&lt;cfoutput query=”TodaysOrders”&gt;<br>
 	order: #orderID#, placed by<br>
	&lt;cfif val(creatorID)&gt;#customerName#&lt;cfelse&gt;#vendorName#&lt;/cfif&gt;<br>
&lt;/cfoutput&gt;</code></p>
<p>Here is another solution – I added creatorIDtype field that indicates if the creatorID is a customer or a vendor:</p>
<p><code>SELECT orders.*,<br>
name =<br>
CASE e.creatorIDtype<br>
		WHEN 'CUSTOMER' THEN customer.name<br>
	      	ELSE vendor.name<br>
	    	END<br>
FROM orders<br>
LEFT JOIN customers on orders.creatorID = customers.customerID<br>
LEFT JOIN  vendors on orders.creatorID = vendors.vendorID</code></p>
<p>Now the view code does not need to be changed, the “name” column will continue to hold the name of the person who placed the order, regardless if it was a customer or a vendor.</p>
				</div>

				<p class="post-meta">Posted by Ryan on May 22 2011 at 7:40 pm under <a href="/category/sql/" rel="category tag">SQL</a>.<br><a href="/joining-two-tables-one-id/#comments">6 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-764"><a href="/concatenating-child-rows/" rel="bookmark" title="Permanent Link to Concatenating child rows in SQL &#8211; Cross Apply / FOR XML PATH">Concatenating child rows in SQL &#8211; Cross Apply / FOR XML PATH</a></h3>
				</div></div>

				<div class="post-entry">
					<p>Here&#8217;s a neat trick when you need to concatenate child rows in a SQL Select statement.  What do I mean by that? Its a little hard to explain, so I&#8217;ll try to illustrate below.</p>
<p>Say you have these two database tables:</p>
<table style="background-color: #FFEF0A; margin-right: 40px;" border="1" align="left">
<caption>orders</caption>
<tr>
<td><b>OrderID</b></td>
<td><b>OrderNotes</b></td>
</tr>
<tr>
<td>1</td>
<td>Notes about order 1</td>
</tr>
<tr>
<td>2</td>
<td>Notes about order 2</td>
</tr>
<tr>
<td>3</td>
<td>Notes about order 3</td>
</tr>
</table>
<table style="background-color: #FFEF0A;" border="1">
<caption>orderLines</caption>
<tr>
<td><b>LineItemID</b></td>
<td><b>OrderID</b></td>
<td><b>LineNotes</b></td>
</tr>
<tr>
<td>50</td>
<td>1</td>
<td>ABC</td>

</tr>
<tr>
<td>51</td>
<td>1</td>
<td>XYZ</td>

</tr>
<tr>
<td>52</td>
<td>2</td>
<td>HJK</td>

</tr>
<tr>
<td>53</td>
<td>2</td>
<td>DEF</td>

</tr>
<tr>
<td>54</td>
<td>2</td>
<td>KLM</td>

</tr>
</table>
<p>Using the SQL trick below you will end up with a result set that looks like this:</p>
<table cellpadding="5" border="1">
<tr>
<td><b>OrderID</b></td>
<td><b>OrderNotes</b></td>
<td><b>listOfLineNotes</b></td>
</tr>
<tr>
<td>1</td>
<td>Notes about order 1</td>
<td>ABC,XYZ</td>
</tr>
<tr>
<td>2</td>
<td>Notes about order 2</td>
<td>HJK,DEF,KLM</td>
</tr>
<tr>
<td>3</td>
<td>Notes about order 3</td>
<td>NULL</td>
</tr>
</table>
<p>When would you need to do this?  I&#8217;ve need it a couple times.  One was when we were grabbing database records to index into Verity.  We wanted not only data from the orders table, but also wanted to index all the notes on each line item, which were separate records in a different table.  We didn&#8217;t want to index these separately, because if there was a match in a Verity search we wanted to return the order, not the line item.  Using the query below we were able to combine all this data into one query.</p>
<pre><code>SELECT *
FROM orders AS o
CROSS APPLY (
	SELECT linenotes + ','
	FROM orderLines AS ol
	WHERE ol.orderID = o.orderID 
	FOR XML PATH('') )
temp ( listOfLineNotes )</code></pre>
<p>Using this code, listOfLineNotes will be a comma separated list of all the line item notes for this order.</p>
<p>Another time this trick came in handy was when we needed to get some records from a literature database table to display on our public website.  We were going to do some filtering using JavaScript, so needed a field in each literature item row that contained a list of all the categories the item was in.  This was an easy way to accomplish that.</p>
				</div>

				<p class="post-meta">Posted by Ryan on October 20 2010 at 10:39 am under <a href="/category/sql/" rel="category tag">SQL</a>.<br><a href="/concatenating-child-rows/#comments">8 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-699"><a href="/mysql-losing-case-in-table-names/" rel="bookmark" title="Permanent Link to MySQL losing case in table names">MySQL losing case in table names</a></h3>
				</div></div>

				<div class="post-entry">
					<p>I had an issue recently when I was working with a couple other developers on a project.  We keep our MySQL database in sync by exporting the database as an SQL script and sharing it in a subversion repository (I wish MS SQL could be this easy!).  Our table names are saved with mix case, like &#8220;userFiles&#8221;, but everytime I would export my database the tables would come out all lower case, like &#8220;userfiles&#8221;.</p>
<p>Turns out this is a simple thing to fix, I had to add a line to MySQL&#8217;s config file: <em>my.cnf</em>.  Mine was located at <em>[MySQL installed root]\bin\my.cnf</em>.  The setting that needs to change is lower_case_table_names, I set the value to 2, like this:</p>
<p><code>lower_case_table_names=2</code></p>
<p>If you are interested, here are the different possible values:</p>
<table>
<tbody>
<tr>
<td valign="top"><span class="bold"><strong>Value</strong></span></td>
<td><span class="bold"><strong>Meaning</strong></span></td>
</tr>
<tr>
<td valign="top">0</td>
<td>Table and database names are stored on disk using the lettercase<br>
                specified in the CREATE  TABLE or CREATE DATABASE statement. Name comparisons are case<br>
                sensitive. Note that if you force this variable to 0 with &#8211;lower-case-table-names=0<br>
                on a case-insensitive file system and access MyISAM tablenames using different<br>
                lettercases, index corruption may result.</td>
</tr>
<tr>
<td valign="top">1</td>
<td>Table names are stored in lowercase on disk and name comparisons are not<br>
                case sensitive. MySQL converts all table names to<br>
                lowercase on storage and lookup. This behavior also<br>
                applies to database names and table aliases.</td>
</tr>
<tr>
<td valign="top">2</td>
<td>Table and database names are stored on disk using the lettercase<br>
                specified in the CREATE TABLE or CREATE  DATABASE statement, but MySQL converts them to<br>
                lowercase on lookup. Name comparisons are not case sensitive. This works only on file<br>
                systems that are not case sensitive! InnoDB table names are stored in<br>
                lowercase, as for lower_case_table_names=1.</td>
</tr>
</tbody>
</table>
<p>On Windows the default is 1.</p>
<p>More information at <a href="http://dev.mysql.com/doc/refman/5.0/en/identifier-case-sensitivity.html">http://dev.mysql.com/doc/refman/5.0/en/identifier-case-sensitivity.html</a></p>
				</div>

				<p class="post-meta">Posted by Ryan on January 3 2010 at 11:24 am under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/system-administration/" rel="category tag">System Administration</a>.<br><a href="/mysql-losing-case-in-table-names/#comments">2 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-361"><a href="/makedate-function-ms-sql-server/" rel="bookmark" title="Permanent Link to A &#8216;MakeDate&#8217; function for MS SQL Server">A &#8216;MakeDate&#8217; function for MS SQL Server</a></h3>
				</div></div>

				<div class="post-entry">
					<p>The other day I had a need to be creating dates in a SQL Server SQL statement, made from a few different text fields.  I could not find a function to create a date from these, so I wrote one (with the help of our in house SQL guru).<br>
 <a href="/makedate-function-ms-sql-server/#more-361" class="more-link"><small>Continue reading &#8216;A &#8216;MakeDate&#8217; function for MS SQL Server&#8217; &raquo;</small></a></p>
				</div>

				<p class="post-meta">Posted by Ryan on April 2 2009 at 9:14 pm under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><a href="/makedate-function-ms-sql-server/#comments">2 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-291"><a href="/query-of-query-bug/" rel="bookmark" title="Permanent Link to A bug with Query of Query and * ?">A bug with Query of Query and * ?</a></h3>
				</div></div>

				<div class="post-entry">
					<p>There may be something buggy here, or maybe I&#8217;m misunderstanding how this should work.</p>
<p>This code executes fine:</p>
<pre><code>&lt;cfquery name="qryListings" dbtype="query"&gt;
SELECT 1 as OrdBy, * FROM qryListings
UNION
SELECT 2 as OrdBy, * FROM qryListingsTmp
ORDER BY OrdBy
&lt;/cfquery&gt;</code></pre>
<p>But when I add a WHERE clause to the second part to filter out records that were in the first group:</p>
<pre><code>&lt;cfquery name="qryListings" dbtype="query"&gt;
SELECT 1 as OrdBy, * FROM qryListings
UNION
SELECT 2 as OrdBy, * FROM qryListingsTmp WHERE ref_num NOT IN
(#ValueList(qryListings.ref_num)#)
ORDER BY OrdBy
&lt;/cfquery&gt;</code></pre>
<p> I get a ColdFusion error about the number of columns being different between the two queries.<br>
<img decoding="async" src="/wp-content/uploads/2009/01/qoq_error.png" alt="" title="query of query error" width="435" height="170" class="alignnone size-full wp-image-292" srcset="/wp-content/uploads/2009/01/qoq_error.png 435w, /wp-content/uploads/2009/01/qoq_error-300x117.png 300w" sizes="(max-width: 435px) 100vw, 435px"></p>
<p> <a href="/query-of-query-bug/#more-291" class="more-link"><small>Continue reading &#8216;A bug with Query of Query and * ?&#8217; &raquo;</small></a></p>
				</div>

				<p class="post-meta">Posted by Ryan on January 20 2009 at 7:32 pm under <a href="/category/coldfusion/" rel="category tag">ColdFusion</a>, <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><a href="/query-of-query-bug/#comments">1 Comment</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-214"><a href="/coldfusion-convert-value-from-column-timestamp/" rel="bookmark" title="Permanent Link to ColdFusion / MySQL Error: Cannot convert value &#8216;0000-00-00 00:00:00&#8217; from column X to TIMESTAMP.">ColdFusion / MySQL Error: Cannot convert value &#8216;0000-00-00 00:00:00&#8217; from column X to TIMESTAMP.</a></h3>
				</div></div>

				<div class="post-entry">
					<p>I ran into this issue when adding a new datetime column to an existing table in my MySQL 5 database.  I did not get the error in my production environment, only the dev environment on my local machine.</p>
<p><img decoding="async" loading="lazy" src="/wp-content/uploads/2008/11/mysql_error_screenshot.png" alt="" title="mysql error screenshot" width="500" height="78" class="alignnone size-full wp-image-215" srcset="/wp-content/uploads/2008/11/mysql_error_screenshot.png 644w, /wp-content/uploads/2008/11/mysql_error_screenshot-300x47.png 300w" sizes="(max-width: 500px) 100vw, 500px"></p>
<p>I was puzzled by this error, because I thought the all zeros value basically meant a null/unknown date value.  Also I wasn&#8217;t using a type TIMESTAMP, I was using a DATETIME column type, so that threw me, too.  After digging through the data a little bit, I found that the values for these new columns in the production database were NULL, but the values in my dev database were &#8216;0000-00-00 00:00:00&#8217;.  A little googling told me that the all zeros value is what happens when an invalid date is assigned to a datetime field.</p>
<p>I could not see any differences in the schema, so I&#8217;m not sure how this happened.  But updating my dev data to be NULL where the value was &#8216;0000-00-00 00:00:00&#8217; solved the problem.</p>
<p>The <em>other</em> option, if you can&#8217;t change your data, is to add these items to your connection string value in the ColdFusion Administrator for your datasource:</p>
<p><code>noDatetimeStringSync=true&amp;zeroDateTimeBehavior=convertToNull</code></p>
<p><img decoding="async" loading="lazy" src="/wp-content/uploads/2008/11/dsn_screenshot.png" alt="" title="mysql connection string screenshot" width="481" height="404" class="alignnone size-full wp-image-216" style="border: 1px solid gray;" srcset="/wp-content/uploads/2008/11/dsn_screenshot.png 481w, /wp-content/uploads/2008/11/dsn_screenshot-300x251.png 300w" sizes="(max-width: 481px) 100vw, 481px"></p>
<p>This tells MySQL to return a null instead of throwing an exception when one of these values is found.  This is how I initially solved the problem, until I figured out that &#8216;0000-00-00 00:00:00&#8217; was not a proper value.</p>
				</div>

				<p class="post-meta">Posted by Ryan on November 20 2008 at 8:14 pm under <a href="/category/coldfusion/" rel="category tag">ColdFusion</a>, <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><a href="/coldfusion-convert-value-from-column-timestamp/#comments">2 Comments</a>.   </p>

			</div>

					<div class="post">
				<div class="post-title"><div>
					<h3 id="post-188"><a href="/pagination-mssql-2005/" rel="bookmark" title="Permanent Link to Elegant pagination with MS SQL 2005">Elegant pagination with MS SQL 2005</a></h3>
				</div></div>

				<div class="post-entry">
					<p>I&#8217;ve never found a great solution for pagination in SQL 2000.  I much prefer MySQL&#8217;s syntax: <code>SELECT * FROM table LIMIT 100,10</code>.  That will get you 10 records starting at the 100th record.  Why MS SQL still doesn&#8217;t offer an opposite to TOP, I don&#8217;t know.  Yes, I&#8217;ve seen the double TOP method where you sort your data twice to end up with the last X rows.  It works, but its not exactly elegant.</p>
<p>But I have come across a new method for pagination using some new 2005 features that is pretty neat.  What I <em>really</em> like about this solution is that it gives you a count of the total number of records, which you usually don&#8217;t get with other pagination methods.<br>
 <a href="/pagination-mssql-2005/#more-188" class="more-link"><small>Continue reading &#8216;Elegant pagination with MS SQL 2005&#8217; &raquo;</small></a></p>
				</div>

				<p class="post-meta">Posted by Ryan on November 12 2008 at 4:56 pm under <a href="/category/sql/" rel="category tag">SQL</a>, <a href="/category/web-development/" rel="category tag">Web Development</a>.<br><a href="/pagination-mssql-2005/#comments">6 Comments</a>.   </p>

			</div>

		
		<div class="navigation">
			<div class="alignleft"><a href="/category/sql/page/2/">&laquo; Previous Entries</a></div>
			<div class="alignright"></div>
		</div>

	
	</div>

	<div id="sidebar">
	<div>
		<ul>
			<li id="text-3" class="widget widget_text">			<div class="textwidget"><center><img style="border: 1px solid gray;" src="/wp-content/uploads/2012/06/ryan-headshot-1.jpg" alt="Ryan Stille"></center></div>
		</li>
<li id="pages-3" class="widget widget_pages">
<h2 class="widgettitle">Pages</h2>

			<ul>
				<li class="page_item page-item-228"><a href="/about/">About Me</a></li>
<li class="page_item page-item-35"><a href="/projects/">My Projects</a></li>
			</ul>

			</li>
<li id="categories-3" class="widget widget_categories">
<h2 class="widgettitle">Article Categories</h2>

			<ul>
					<li class="cat-item cat-item-3">
<a href="/category/ajax-javascript/">AJAX / JavaScript</a>
</li>
	<li class="cat-item cat-item-4">
<a href="/category/bluedragon/">BlueDragon</a>
</li>
	<li class="cat-item cat-item-5">
<a href="/category/book-reviews/">Book Reviews</a>
</li>
	<li class="cat-item cat-item-6">
<a href="/category/coldfusion/">ColdFusion</a>
</li>
	<li class="cat-item cat-item-16">
<a href="/category/css/">CSS</a>
</li>
	<li class="cat-item cat-item-7">
<a href="/category/flex/">Flex</a>
</li>
	<li class="cat-item cat-item-8">
<a href="/category/linux/">Linux</a>
</li>
	<li class="cat-item cat-item-9">
<a href="/category/misc/">Misc</a>
</li>
	<li class="cat-item cat-item-10">
<a href="/category/railo/">Railo</a>
</li>
	<li class="cat-item cat-item-11 current-cat">
<a aria-current="page" href="/category/sql/">SQL</a>
</li>
	<li class="cat-item cat-item-12">
<a href="/category/system-administration/">System Administration</a>
</li>
	<li class="cat-item cat-item-13">
<a href="/category/tomcat/">Tomcat</a>
</li>
	<li class="cat-item cat-item-1">
<a href="/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-14">
<a href="/category/web-development/">Web Development</a>
</li>
			</ul>

			</li>

		<li id="recent-posts-3" class="widget widget_recent_entries">
		<h2 class="widgettitle">Recent Posts</h2>

		<ul>
											<li>
					<a href="/coldfusion-formfield-as-array-cf10/">Accessing form fields as an array in CF10</a>
									</li>
											<li>
					<a href="/onerror-img-image-tag/">Did you know about the onerror attribute of the img tag?</a>
									</li>
											<li>
					<a href="/copying-sql-studio-excel-headers/">Copying data from SQL Studio to Excel</a>
									</li>
											<li>
					<a href="/dateconvert-utc-not-what-you-expect/">Using DateConvert to get a UTC timestamp may not return what you expect</a>
									</li>
											<li>
					<a href="/get-filename-before-calling-cffile/">Getting the client filename before using cffile</a>
									</li>
											<li>
					<a href="/jquery-snippet-to-get-all-input-values/">jQuery snippet to get all input values</a>
									</li>
											<li>
					<a href="/mura-404-page-not-working-in-iis7-fix-it-in-web-config/">Mura 404 page not working in IIS7 &#8211; fix it in web.config</a>
									</li>
											<li>
					<a href="/free-coldfusion-10-beta-hosting/">Free ColdFusion 10 beta hosting</a>
									</li>
											<li>
					<a href="/remove-spaces-columns-cfspreadsheet/">Removing spaces from columns in cfspreadsheet (or any query)</a>
									</li>
											<li>
					<a href="/online-code-formatters/">Online code formatters</a>
									</li>
											<li>
					<a href="/joining-two-tables-one-id/">Joining to one of two tables with one ID</a>
									</li>
											<li>
					<a href="/formatting-cfgrid-with-javascript/">Formatting CFGRID with JavaScript</a>
									</li>
											<li>
					<a href="/cf-form-array-comma-workaround/">Accessing ColdFusion form values as an array</a>
									</li>
											<li>
					<a href="/loading-fckeditor-dynamically/">Loading CFrichtext / FCKeditor on-the-fly</a>
									</li>
											<li>
					<a href="/url-rewriting-windows-2008-iis7/">Mura URL rewriting on Windows 2008 / IIS7</a>
									</li>
					</ul>

		</li>
<li id="linkcat-2" class="widget widget_links">
<h2 class="widgettitle">Blogroll</h2>

	<ul class="xoxo blogroll">
<li><a href="http://www.axelscript.com/" title="AxelScript &#8211; Flex development blog">Axel Jensen</a></li>
<li><a href="http://jake.cfwebtools.com/" title="ColdFusion/Flex development">Jake Churchill</a></li>
<li><a href="http://www.coldfusionmuse.com/" title="ColdFusion Muse">Mark Kruger</a></li>
<li><a href="http://www.henke.ws/" title="ColdFusion, TDD, Ant, Subversion, etc.">Mike Henke</a></li>

	</ul>
</li>

<li id="text-4" class="widget widget_text">
<h2 class="widgettitle">Donate</h2>
			<div class="textwidget">If my code has helped you and you'd like give a donation, you can do so using the button below.
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_donations">
<input type="hidden" name="business" value="ryan@stillnet.org">
<input type="hidden" name="lc" value="US">
<input type="hidden" name="item_name" value="Donation for helpful ColdFusion code">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="bn" value="PP-DonationsBF:btn_donateCC_LG.gif:NonHostedGuest">
<input type="image" src="https://www.paypal.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
</div>
		</li>
<li id="text-5" class="widget widget_text">			<div class="textwidget">
<br><br>
<img src="/wp-content/uploads/2010/01/acp_logo.gif">
</div>
		</li>
			
		</ul> 
	</div>
	</div>
</div> <!-- wrapper -->

<div id="footer"><div><div><div>

	<a href="/feed/">Entries (RSS)</a> and <a href="/comments/feed/">Comments (RSS)</a>. Valid <a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional"><abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a> and <a href="http://jigsaw.w3.org/css-validator/check/referer"><abbr title="Cascading Style Sheets">CSS</abbr></a>.<br>

	Powered by <a href="http://www.wpthemes360.com/">Wordpress Themes</a>. Theme <a href="http://srinig.com/wordpress-themes/evanescence/">Evanescence</a> by <a href="http://srinig.com/">Srini G</a>

	</div></div></div></div>

</div> <!-- page -->

</body>

</html>